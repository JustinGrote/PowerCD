name: PowerCD Build
on: push

jobs:
  build:
    name: Build
    runs-on: ${{ matrix.os }}
    strategy:
      fail-fast: false
      matrix:
        os:
          - windows-latest
          - ubuntu-latest
          - macOS-latest
    steps:
      - name: Dump GitHub context
        env:
          GITHUB_CONTEXT: ${{ toJson(github) }}
        run: echo "$GITHUB_CONTEXT"
      - name: Dump job context
        env:
          JOB_CONTEXT: ${{ toJson(job) }}
        run: echo "$JOB_CONTEXT"
      - name: Dump steps context
        env:
          STEPS_CONTEXT: ${{ toJson(steps) }}
        run: echo "$STEPS_CONTEXT"
      - name: Dump runner context
        env:
          RUNNER_CONTEXT: ${{ toJson(runner) }}
        run: echo "$RUNNER_CONTEXT"
      - name: Dump strategy context
        env:
          STRATEGY_CONTEXT: ${{ toJson(strategy) }}
        run: echo "$STRATEGY_CONTEXT"
      - name: Dump matrix context
        env:
          MATRIX_CONTEXT: ${{ toJson(matrix) }}
        run: echo "$MATRIX_CONTEXT"
      - uses: actions/checkout@master
      - name: Setup tmate debug session
        uses: mxschmitt/action-tmate@v1
      - name: Pwsh Test
        shell: pwsh
        run: |
          gci | % fullname | out-string
          pwd | % path | out-string
          . .\build.ps1
          # iex (iwr https://gist.githubusercontent.com/JustinGrote/0ffbe5f514d5d6e5b5a62354a6545738/raw/TestAction.ps1)

          # "##[section]Section Header"
          # "##[command]Command Definition"
          # "##[debug]Debug Line"
          # "##[warning]StandaloneWarning - Doesn't escape the special but it colors, must be a bug!"
          # "##[error]Kill this script maybe? - Also doesn't escape the special code"
          # "Nope still running!"

          # "##[group]BasicColorTest"
          # (30..37 + 90..97) | foreach {
          #   "`e[${PSItem}m $PSItem"
          # }
          # "##[endgroup]"

          # "##[group]256 Color Test"
          # "`e[38;5;69m I should be Blue"
          # "##[endgroup]"

          # "##[group]24 Bit Color"
          # "`e[38;2;255;100;0mI Should Be Orange, but I'm not, so no 24 bit"
          # "##[endgroup]"

          # "##[group]Marvin the Martian"
          # iex (iwr https://gist.githubusercontent.com/JustinGrote/001e93fccda6ebec9f35b22a1dff6e16/raw/744b3f88d65ccd0ad8c1a365830e60abd9863941/MarvinAscii.ps1)
          # "##[endgroup]"

